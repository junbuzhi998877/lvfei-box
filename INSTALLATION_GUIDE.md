# 多功能工具箱应用 - 安装指南

## 环境要求

- Node.js >= 16.x (仅开发环境需要)
- npm >= 8.x (仅开发环境需要)
- Windows 10/11 或 macOS 10.15+

> **注意**: 应用现已内置JRE (Java Runtime Environment)，您无需在系统中安装Java即可使用PDF转OFD功能。

## 安装步骤

1. 克隆或下载项目代码到本地

2. 安装依赖包
   ```bash
   npm install
   ```
   
   注意: 安装过程中可能会出现一些过时包的警告信息，这些不影响应用的正常运行。

3. 启动开发环境
   ```bash
   npm run dev:react
   ```
   
   这个命令会同时启动:
   - Vite开发服务器 (端口5178)
   - Electron应用程序

## 功能测试

安装完成后，可以测试以下功能:

1. **PDF转OFD功能（更新）**
   - 启动应用，进入PDF工具模块
   - 选择"PDF转其他格式"，然后选择"OFD"格式
   - 系统会自动启动内置的PDF转OFD工具
   - 如果已上传PDF文件，则直接使用该文件
   - 如果未上传文件，将由Java程序提供文件选择对话框
   - 注意：应用已内置JRE，无需额外安装Java即可使用此功能

2. **PDF转换功能（全新重设计界面）**
   - 启动应用，进入PDF工具模块
   - 体验全新的三步骤引导流程：
     1. 选择转换方向（PDF转其他格式或其他格式转PDF）
     2. 选择目标格式（Word、Excel、PPT、图片或OFD）
     3. 上传文件
   - 注意体验以下改进功能：
     - 可点击的步骤指示器，支持在各步骤间自由切换
     - 带有品牌颜色和选中状态的格式卡片
     - 带有渐变背景的现代化上传区域
     - 自动发票检测（针对PDF转OFD时）
   - 完成上传后，点击开始转换按钮
   - 查看转换结果并保存文件

3. **二维码生成**
   - 输入文本或URL
   - 选择尺寸和颜色
   - 生成二维码
   - 单个保存或批量保存

4. **图片压缩**
   - 上传图片
   - 调整压缩质量
   - 压缩图片
   - 保存压缩后的图片

## 界面更新说明

**PDF转换界面** 已进行全面改版，主要变化：

1. 采用苹果风格设计语言，实现了更现代、更直观的用户界面
2. 改进了用户引导流程，采用可交互的步骤指示器（1-2-3数字圆形指示）
3. 使用卡片式布局优化转换方向选择和格式选择，视觉层次更加清晰
4. 为不同格式添加了独特的品牌色彩和图标标识，增强视觉识别性
5. 美化了上传区域，采用渐变背景和动态元素，提升交互体验
6. 改进了文件卡片显示，增加成功和错误状态的视觉反馈
7. 优化了发票检测功能，可自动识别电子发票并应用专用转换流程
8. 完善了整体响应式布局，在从大屏幕到移动设备的各种尺寸下都有良好表现

## 已知问题及解决方案

1. **GPU进程错误**
   - 错误信息: `GPU process exited unexpectedly: exit_code=-1073740791`
   - 解决方案: 这是Electron的已知问题，不影响应用的主要功能。如果遇到界面渲染问题，可以尝试在启动时添加`--disable-gpu`参数。

2. **二维码单个保存功能（已修复）**
   - 错误信息: `二维码下载错误: TypeError: window.electronAPI.saveQR is not a function`
   - 解决方案: 我们已经修复了此问题。在`preload.js`中添加了`saveQR`函数的暴露，并在`main.js`中实现了相应的`save-qr`事件处理程序。

3. **发票检测功能（注意事项）**
   - 针对PDF转OFD功能，系统会自动检测PDF是否为发票类型。如果检测为发票，会应用专用的处理流程。
   - 如果检测不准确，用户可以手动选择发票专用处理选项。

## 构建应用

完成开发后，可以构建生产版本:

```bash
npm run build:electron
```

构建完成后，可执行文件将在`release`目录中生成。

## 常见问题

1. **问题**: 启动时提示"Module not found"错误
   **解决方案**: 执行`npm rebuild`命令，重新构建本地依赖

2. **问题**: Java环境检测失败
   **解决方案**: 确保系统安装了Java JDK，并设置了`JAVA_HOME`环境变量

3. **问题**: 图片处理功能不工作
   **解决方案**: 检查是否安装了必要的图形处理依赖，在Windows上可能需要额外安装Visual C++ Redistributable

4. **问题**: PDF转换界面样式显示不正常
   **解决方案**: 清除浏览器缓存或重启应用，确保新样式被正确加载。如果问题仍然存在，请尝试执行`npm run build:css`命令重新构建样式文件。

## 更多信息

详细的项目说明和API文档请参考项目根目录的`README.md`文件。 